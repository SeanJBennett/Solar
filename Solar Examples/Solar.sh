#!/bin/bash

module purge

module load openmpi-2.0/gcc

mkdir /scratch/"$SLURM_JOB_ID"

echo mpirun --mca btl openib,self -np "${1}" "${2}" /scratch/"$SLURM_JOB_ID"/data_ "${4}" "${5}" "${6}" "${7}" "${8}" "${9}" "${10}" "${11}" "${12}" "${13}" "${14}" "${15}" "${16}" "${17}" "${18}" "${19}" "${20}" "${21}" "${22}" "${23}" "${24}" "${25}" "${26}" "${27}" "${28}" "${29}" "${30}" "${31}" "${32}" "${33}" "${34}" "${35}" "${36}"

time mpirun --mca btl openib,self -np "${1}" "${2}" /scratch/"$SLURM_JOB_ID"/data_ "${4}" "${5}" "${6}" "${7}" "${8}" "${9}" "${10}" "${11}" "${12}" "${13}" "${14}" "${15}" "${16}" "${17}" "${18}" "${19}" "${20}" "${21}" "${22}" "${23}" "${24}" "${25}" "${26}" "${27}" "${28}" "${29}" "${30}" "${31}" "${32}" "${33}" "${34}" "${35}" "${36}"

echo mv /scratch/"$SLURM_JOB_ID"/data_*.nc "${3}"

mv /scratch/"$SLURM_JOB_ID"/data_*.nc "${3}"

rm -rf /scratch/"$SLURM_JOB_ID"